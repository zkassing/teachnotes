# 正则表达式

什么是正则表达式?

正则表达式是一种表达式. 用于描述规则

使用正则表达式, 可以匹配出你想要的字符串

台湾: 规则表达式

外国友人: "你们中国人的手机号, 是什么样子的?"

1. 一串数字(不能有字母)
1. 11 位
1. 1 开头
1. 13/15/17/18/19
1. 举个栗子: `15639278999`

用计算机能够理解的语言, 来描述规则

`/^1[35789]\d{9}$/` 匹配手机号的正则表达式

> 理论上, 没有什么情况是非用正则不可的, 但是该用的时候不用, 代码就会比较复杂

不使用正则, 来验证手机号

```javascript
// 1. 一串数字(不能有字母)
// 2. 11位
// 3. 1开头
// 4. 13/15/17/18/19
// 5. 举个栗子: 15639278999

var phone = "15567890989";
var res = isPhone(phone);

console.log(res);

function isPhone(str) {
    if (str.length !== 11) {
        console.log("不是十一位");
        return false;
    }

    if (str[0] !== "1") {
        console.log("不是以一开头");
        return false;
    }
    if (str[1] === "1" || str[1] === "2" || str[1] === "4" || str[1] === "0") {
        console.log("第二位不正确");
        return false;
    }
    for (var i = 0; i < phone.length; i++) {
        if (!(phone[i] >= 0 && phone[i] <= 9)) {
            console.log("有字母, 你丫写错了.");

            return false;
        }
    }

    return true;
}
```

# 字符串操作

## search

```javascript
var str = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

console.log(str.search("B")); // 返回位置, 如果没有, -1 , 现在这个结果返回1
console.log(str.search("BCD")); // 会把整个字符串当成一个整体, 返回位置, 如果没有, -1 , 现在这个结果返回1
console.log(str.search("BHD")); // BHD取不到 -1
```

## substring (获取子字符串)

```javascript
var str = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

console.log(str.substring(2, 5)); // cde [起始位置,结束位置)
console.log(str.slice(2, 5)); // cde [起始位置,结束位置)
```

## substr (获取子字符串, 第二个参数表示`个数`)

```javascript
console.log(str.substr(2, 5)); // cdefg 起始位置,截取个数
```

## slice 和 substring

```javascript
console.log(str.substring(2, 5)); // cde [起始位置,结束位置)
console.log(str.substring(5, 5)); // cde 自动切换起始位置和结束位置, 小的数字放前面
console.log(str.slice(2, 5)); // cde [起始位置,结束位置)
console.log(str.slice(5, 5)); // 起始位置>=结束位置 截不到
```

## 负数时, 它们之间的不同

```javascript
// 负数表示倒数(从后往前数)
console.log(str.slice(2, -5)); // ==> 2, length-5
console.log(str.slice(2, 21));
// 它俩一样
console.log(str.slice(-2, 5));
console.log(str.slice(26 - 2, 5)); // 前面大于等于后面, 取不到
```

```javascript
// 负数会转成0, 下面两条一样

console.log(str.substring(-2, 5));
console.log(str.substring(0, 5));

// 它们一样
console.log(str.substring(2, -5));
console.log(str.substring(2, 0));
console.log(str.substring(0, 2));
```

```javascript
// 前面两个是一样的
console.log(str.substr(-2, 5)); // 第一个参数如果是负数, 则总长度加负数
console.log(str.substr(24, 5));
console.log(str.substr(2, -5)); // 第二个是个数, 0或者负数, 取不到
```

## 复习: 字符串转数组

```javascript
var str = "I love china";
// ['I','love','china']
console.log(str.split(" "));
```

## 数组转字符串

```javascript
var arr = ["The", "quick", "brown", "fox", "jumps", "over", "the", "lazy", "dog"];

console.log(arr.join("_")); // The_quick_brown_fox_jumps_over_the_lazy_dog
```

# 找出字符串中的所有数字

```javascript
var str = "213 hel    666 l4o w009orld 777 china ----45";
// [213,666,777,45]
var arr = [];
// var str_arr = str.split(" ");

for (var i = 0; i < str.length; i++) {
    if (str[i] >= 0 && str[i] <= 9) {
        arr.push(str[i]);
    }
}
var final_str = arr.join("");
var final_arr = final_str.split(" ");
var show_arr = [];
for (var i = 0; i < final_arr.length; i++) {
    if (final_arr[i]) {
        show_arr.push(final_arr[i]);
    }
}

console.log(show_arr);
```

# 正则如何使用

```javascript
var str = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

var reg = new RegExp("d", "i");
var reg = new RegExp("D", "i"); // i ignore 忽略大小写
console.log(str.search(reg)); // 3 位置, 下标, 取不到-1
```

## 简写的风格

```javascript
var str = "ABCDEFGH111IJKLMNOPQRSTUVWXYZ";

console.log(str.search(/\d+/)); // 8 位置, 下标, 取不到-1

var reg = /\d+/; // perl风格, perl很古老的语言, 最早提出正则的概念

console.log(str.search(reg));
```

## match

返回匹配到的结果, 数组形式, 匹配不到 null

```javascript
var str = "213 hel    666 l4o w009orld 777 china ----45";

console.log(str.match(/\d+/g));
// [ '213', '666', '4', '009', '777', '45' ]
```

## replace

```javascript
var str = "I love China China";

// 下面两个一样
console.log(str.replace(/China/, "USA")); // 正则 I love USA China
console.log(str.replace("China", "USA")); // 字符串 I love USA China
// 如果想替换多个, 需要正则global
console.log(str.replace(/China/g, "USA")); // 正则 I love USA USA
console.log(str.replace("China", "USA")); // 字符串 I love USA China
```

## 小应用

> 敏感词过滤

```html
<!DOCTYPE html>
<html lang="zh">
    <head>
        <script src="js/jquery.js"></script>
    </head>
    <body>
        <textarea name="tmp" id="txt1" cols="30" rows="10"></textarea>
        <br />
        <input type="button" value="和谐" />
        <br />
        <textarea name="tmp" id="txt2" cols="30" rows="10"></textarea>
        <script>
            $(function() {
                var reg = /共产党|政府|警察/g;
                $("input").click(function() {
                    var old_str = $("#txt1").val();
                    console.log(old_str);

                    var new_str = old_str.replace(reg, "***");
                    console.log(new_str);

                    $("#txt2").val(new_str);
                });
            });
        </script>
    </body>
</html>
```

## 正则的语法

### 方括号的用法

`[abc] 任意字符`

```javascript
var str = "am bm cm dm em fm hm jm km mm nm pm qm sm tm um wm xm zm";

console.log(str.match(/[acdefkmnpsu]m/g));

// [ 'am', 'cm', 'dm', 'em', 'fm', 'km', 'mm', 'nm', 'pm', 'sm', 'um' ]
```

## 范围

`[a-z][0-9]`

```javascript
var str = "kdjsfkl 22 jsdkf 33 ---- 44 555";

// [a-z]
console.log(str.match(/[a-z]+/g));
console.log(str.match(/[a-z0-9]+/g));
```

```javascript
var str = "kdjsfkl 22 jsdkf 33 ---- 44 555";

// 方括号中 ^ 取反

console.log(str.match(/[^a-z]+/g));
```

## 爬小说

```javascript
<!DOCTYPE html>
<html lang="zh">
    <head>
        <script src="js/jquery.js"></script>
    </head>
    <body>
        <textarea name="tmp" id="txt1" cols="30" rows="10"></textarea>
        <br />
        <input type="button" value="和谐" />
        <br />
        <textarea name="tmp" id="txt2" cols="30" rows="10"></textarea>
        <script>
            $(function() {
                $("input").click(function() {
                    var old_str = $("#txt1").val();
                    var changeBrReg = /<br>/g
                    var removeTag = /<[^<>]+>/g
                    old_str = old_str.replace(changeBrReg, "\n"); // 替换br
                    old_str = old_str.replace(removeTag, ""); // 删除标签

                    $("#txt2").val(old_str);
                });
            });
        </script>
    </body>
</html>

```

## 转义

`\D\d`

`\d` 数字

`\D`取反 非数字

`\S\s`

`\s`空白字符

`\S`取反, 非空字符

`\W\w`

`\w` `[A-Za-a0-9_]`

`\W`取反

`.`全部字符

## 量词

> 出现的次数

`{n,m}` 最少 出现 n 次, 最多出现 m 次

## 常用的量词

`{n,}`最少 n 次, 多了不限

`*`任意多次

`?`{0,1} 一次或者没有 可有可无

`+`{1,} 一次或多次(若干)

`{n}`正好 n 次

## 匹配座机号

```javascript
var str = "0371-2536565-010 010-25648465 3564765-09";

// 0开头(共计3-4)
// 座机号(第一位不能0开头,共计7-8位)
// 分机号(共计1-5位)
// 区号和分机号可以省略

console.log(str.match(/(0[1-9]\d{1,2}-)?[1-9]\d{6,7}(-\d{1,5})?/g));
```

## 验证邮箱

```javascript
var email = "xujunhao23@126.cn";
var email1 = "778987678@qq.com";
var email2 = "yunhe@vip.com.cn";

// 1. 必须有@
// 2. @前面 英文数字下划线
// 3. @后面 英文数字+点+英文(2-4位)

var re = /^\w+@[a-z0-9]+\.[a-z]{2,4}(\.[a-z]{2,4})?$/;
console.log(re.test(email2));
```

## 验证手机号

1. 1 开头
1. 11 位
1. 全是数字
1. 第二位 356789

`^1[356789]\d{9}$`

```javascript
// 1. 一串数字(不能有字母)
// 2. 11位
// 3. 1开头
// 4. 13/15/17/18/19
// 5. 举个栗子: 15639278999

var phone = "15567890989";
// var res = isPhone(phone);

// console.log(res);

// function isPhone(str) {
//     if (str.length !== 11) {
//         console.log("不是十一位");
//         return false;
//     }

//     if (str[0] !== "1") {
//         console.log("不是以一开头");
//         return false;
//     }
//     if (str[1] === "1" || str[1] === "2" || str[1] === "4" || str[1] === "0") {
//         console.log("第二位不正确");
//         return false;
//     }
//     for (var i = 0; i < phone.length; i++) {
//         if (!(phone[i] >= 0 && phone[i] <= 9)) {
//             console.log("有字母, 你丫写错了.");

//             return false;
//         }
//     }

//     return true;
// }

console.log(/^1[34578]\d{9}$/g.test(phone));
```

## 验证中文名

```javascript
var name = "徐晓航";

// 2-6
var re = /^[赵|钱|孙|李|周|吴|郑|王|冯|陈|楮|卫|蒋|沈|韩|杨|朱|秦|尤|许|何|吕|施|张|孔|曹|严|华|金|魏|陶|姜|戚|谢|邹|喻|柏|水|窦|章|云|苏|潘|葛|奚|范|彭|郎|鲁|韦|昌|马|苗|凤|花|方|俞|任|袁|柳|酆|鲍|史|唐|费|廉|岑|薛|雷|贺|倪|汤|滕|殷|罗|毕|郝|邬|安|常|乐|于|时|傅|皮|卞|齐|康|伍|余|元|卜|顾|孟|平|黄|和|穆|萧|尹|姚|邵|湛|汪|祁|毛|禹|狄|米|贝|明|臧|计|伏|成|戴|谈|宋|茅|庞|熊|纪|舒|屈|项|祝|董|梁|杜|阮|蓝|闽|席|季|麻|强|贾|路|娄|危|江|童|颜|郭|梅|盛|林|刁|锺|徐|丘|骆|高|夏|蔡|田|樊|胡|凌|霍|虞|万|支|柯|昝|管|卢|莫|经|房|裘|缪|干|解|应|宗|丁|宣|贲|邓|郁|单|杭|洪|包|诸|左|石|崔|吉|钮|龚|程|嵇|邢|滑|裴|陆|荣|翁|荀|羊|於|惠|甄|麹|家|封|芮|羿|储|靳|汲|邴|糜|松|井|段|富|巫|乌|焦|巴|弓|牧|隗|山|谷|车|侯|宓|蓬|全|郗|班|仰|秋|仲|伊|宫|宁|仇|栾|暴|甘|斜|厉|戎|祖|武|符|刘|景|詹|束|龙|叶|幸|司|韶|郜|黎|蓟|薄|印|宿|白|怀|蒲|邰|从|鄂|索|咸|籍|赖|卓|蔺|屠|蒙|池|乔|阴|郁|胥|能|苍|双|闻|莘|党|翟|谭|贡|劳|逄|姬|申|扶|堵|冉|宰|郦|雍|郤|璩|桑|桂|濮|牛|寿|通|边|扈|燕|冀|郏|浦|尚|农|温|别|庄|晏|柴|瞿|阎|充|慕|连|茹|习|宦|艾|鱼|容|向|古|易|慎|戈|廖|庾|终|暨|居|衡|步|都|耿|满|弘|匡|国|文|寇|广|禄|阙|东|欧|殳|沃|利|蔚|越|夔|隆|师|巩|厍|聂|晁|勾|敖|融|冷|訾|辛|阚|那|简|饶|空|曾|毋|沙|乜|养|鞠|须|丰|巢|关|蒯|相|查|后|荆|红|游|竺|权|逑|盖|益|桓|公|万俟|司马|上官|欧阳|夏侯|诸葛|闻人|东方|赫连|皇甫|尉迟|公羊|澹台|公冶|宗政|濮阳|淳于|单于|太叔|申屠|公孙|仲孙|轩辕|令狐|锺离|宇文|长孙|慕容|鲜于|闾丘|司徒|司空|丌官|司寇|仉|督|子车|颛孙|端木|巫马|公西|漆雕|乐正|壤驷|公良|拓拔|夹谷|宰父|谷梁|晋|楚|阎|法|汝|鄢|涂|钦|段干|百里|东郭|南门|呼延|归|海|羊舌|微生|岳|帅|缑|亢|况|后|有|琴|梁丘|左丘|东门|西门|商|牟|佘|佴|伯|赏|南宫|墨|哈|谯|笪|年|爱|阳|佟|第五|言|福][\u4E00-\u9FA5]{1,5}$/;
console.log(re.test(name));
```
